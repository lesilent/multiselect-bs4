<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/css/bootstrap.min.css" integrity="sha512-rt/SrQ4UNIaGfDyEXZtNcyWvQeOq0QLygHluFQcSjaGB04IxWhal71tKuzP6K8eYXYB6vJV4pHkXcmFGGQ1/0w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer" defer="defer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.bundle.min.js" integrity="sha512-igl8WEUuas9k5dtnhKqyyld6TzzRjvMqLC79jkgT3z02FvJyHAuUtyemm/P/jYSne1xwFI06ezQxEwweaiV7VA==" crossorigin="anonymous" referrerpolicy="no-referrer" defer="defer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js" integrity="sha512-Tn2m0TIpgVyTzzvmxLNuqbSJH3JP8jm+Cy3hvHrW7ndTDcJ1w5mBiksqDBb8GpE2ksktFvDB/ykZ0mDpsZj20w==" crossorigin="anonymous" referrerpolicy="no-referrer" defer="defer"></script>
<script src="js/multiselect-bs4.min.js?" defer="defer"></script>
<style>
.form-control::placeholder {
	opacity: 0.5 !important;
}
</style>
</head>
<body>
<div class="container py-3">
<div class="d-flex justify-content-between">
	<div><h1 class="display-4">mutiselect-bs4</h1></div>
	<div><a href="https://github.com/lesilent/mutiselect-bs4"><i class="fab fa-github fa-lg m-2"></i></a></div>
</div><!-- /.d-flex -->
<div class="list-group">
<div class="list-group-item bg-light font-weight-bolder">Options</div>
<div class="list-group-item"><form id="custom-form" autocomplete="off" onsubmit="return false">
<div class="row">
	<div class="form-group col-6 col-md-4 col-lg-3">
		<label for="selectAll">Select All Option:</label>
		<div class="input-group">
		<select id="selectAll" class="form-control" name="selectAll" disabled="disabled">
		<option value="0" data-include-select-all-option-min="false" selected="selected">No</option>
		<option value="1" data-include-select-all-option-min="false">Yes (Always)</option>
		<option value="0" data-include-select-all-option-min="true">Yes (&ge; # Options)</option>
		</select>
		<div class="input-group-append"><button type="button" id="selectAll-reset-btn" class="btn btn-outline-secondary" disabled="disabled"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-md-4 col-lg-3">
		<label for="selectAllMin"># Options for Select All</label>
		<div class="input-group">
		<input type="number" id="selectAllMin" class="form-control" name="selectAllMin" value="" min="1" max="9999" pattern="(\d{1,5})?" maxlength="4" readonly="readonly" disabled="disabled" />
		<div class="input-group-append"><button type="button" id="selectAllMin-reset-btn" class="btn btn-outline-secondary" disabled="disabled"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-md-4 col-lg-3">
		<label for="selectAllText">Select All Text:</label>
		<div class="input-group">
		<input type="text" id="selectAllText" class="form-control" name="selectAllText" value="" placeholder="All" maxlength="100" readonly="readonly" disabled="disabled" />
		<div class="input-group-append"><button type="button" id="selectAllText-reset-btn" class="btn btn-outline-secondary" disabled="disabled"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-md-4 col-lg-3">
		<label for="collapsibleOptGroups">Collapsible Optgroups:</label>
		<div class="input-group">
		<select id="collapsibleOptGroups" class="form-control" name="collapsibleOptGroups">
		<option value="0" data-enable-collapsible-opt-groups="false" data-collapse-opt-groups-by-default="false" selected="selected">No</option>
		<option value="1" data-enable-collapsible-opt-groups="true" data-collapse-opt-groups-by-default="false">Yes (Expanded)</option>
		<option value="1" data-enable-collapsible-opt-groups="true" data-collapse-opt-groups-by-default="true">Yes (Collapsed)</option>
		</select>
		<div class="input-group-append"><button type="button" id="collapsibleOptGroups-reset-btn" class="btn btn-outline-secondary" disabled="disabled"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
	<div class="form-group col-6 col-md-4 col-lg-3">
		<label for="filtering">Search Filter:</label>
		<div class="input-group">
		<select id="filtering" class="form-control" name="filtering">
		<option value="0" data-enable-filtering="false" data-enable-case-sensitive-filtering="false" selected="selected">No</option>
		<option value="1" data-enable-filtering="true" data-enable-case-sensitive-filtering="false">Yes (Case-Insensitive)</option>
		<option value="1" data-enable-filtering="true" data-enable-case-sensitive-filtering="true">Yes (Case-Sensitive)</option>
		</select>
		<div class="input-group-append"><button type="button" id="filtering-reset-btn" class="btn btn-outline-secondary" disabled="disabled"><i class="far fa-times-circle"></i></button></div>
		</div><!-- /.input-group -->
	</div><!-- /.form-group -->
</div><!-- /.row -->
</form>
<div><small class="text-secondary">Note: the example multiselect below has <span id="option-count">X</span> options, so only <code>includeSelectAllOptionMin</code> values less than or equal to this will trigger the select all option to appear.</small></div>
</div><!-- /.list-group-item -->
<div class="list-group-item bg-light font-weight-bolder">Result</div>
<div id="multiselect-result" class="list-group-item">
</div><!-- /.list-group-item -->
<div class="list-group-item bg-light font-weight-bolder">JavaScript</div>
<div class="list-group-item"><pre class="mb-0"><code id="multiselect-javascript">jQuery('select.multiselect').multiselect(<span id="multiselect-params"></span>);</code></pre></div>
<div class="list-group-item bg-light font-weight-bolder">Original</div>
<div class="list-group-item">
	<select id="multiselect-select-original" class="form-control multiselect-select" name="multiselect[]" multiple="multiple" autocomplete="off">
	<option value="a">Andrew</option>
	<option value="a">Alex</option>
	<optgroup label="Accounting">
		<option value="b">Bob</option>
		<option value="c">Charles</option>
		<option value="d">David</option>
		<option value="e">Erin</option>
	</optgroup>
	<optgroup label="Engineering">
		<option value="f">Frank</option>
		<option value="g">Greg</option>
		<option value="h">Helen</option>
	</optgroup>
	<option value="i">Iris</option>
	<option value="j">John</option>
	<option value="k" disabled="disabled">Kevin (Disabled)</option>
	<option value="l">Larry</option>
	<optgroup label="Marketing">
		<option value="m" disabled="disabled">Mindy (Disabled)</option>
		<option value="n">Nathan</option>
		<option value="o">Opal</option>
	</optgroup>
	<optgroup label="Sales (Disabled)" disabled="disabled">
		<option value="p">Paul</option>
		<option value="q">Quincy</option>
		<option value="r">Roger</option>
		<option value="s">Samuel</option>
	</optgroup>
	<optgroup label="Blank"></optgroup>
	</select>
</div><!-- /.list-group-item -->
</div><!-- /.list-group -->
</div><!-- /.container -->
<script>
document.addEventListener('DOMContentLoaded', function () {
	var $mselect = jQuery('#multiselect-select-original').clone().attr('id', 'multiselect-select').appendTo('#multiselect-result').multiselect();
	var $selectAll = jQuery('#selectAll');
	var $selectAllReset = jQuery('#selectAll-reset-btn').on('click', function () {
		jQuery('#' + this.id.substring(0, this.id.length - 10)).prop('selectedIndex', 0).trigger('change');
		this.disabled = true;
	});
	var defaultAllMin = $mselect.multiselect('includeSelectAllOptionMin');
	var $selectAllMin = jQuery('#selectAllMin').val(defaultAllMin).prop('readOnly', false);
	var $selectAllMinReset = jQuery('#selectAllMin-reset-btn').on('click', function () {
		jQuery('#' + this.id.substring(0, this.id.length - 10)).val(defaultAllMin).trigger('change');
		this.disabled = true;
	});
	var $selectText = jQuery('#selectAllText').attr('placeholder', $mselect.multiselect('selectAllText')).prop('readOnly', false);
	var $selectTextReset = jQuery('#selectAllText-reset-btn').on('click', function () {
		jQuery('#' + this.id.substring(0, this.id.length - 10)).val('').trigger('change');
		this.disabled = true;
	});
	var $collapsibleReset = jQuery('#collapsibleOptGroups-reset-btn').on('click', function () {
		jQuery('#' + this.id.substring(0, this.id.length - 10)).prop('selectedIndex', 0).trigger('change');
		this.disabled = true;
	});
	var $filteringReset = jQuery('#filtering-reset-btn').on('click', function () {
		jQuery('#' + this.id.substring(0, this.id.length - 10)).prop('selectedIndex', 0).trigger('change');
		this.disabled = true;
	});
	jQuery('#collapsibleOptGroups, #filtering, #selectAll, #selectAllMin, #selectAllText').on('change', function () {
		switch (this.id)
		{
			case 'selectAll':
				var disabled = (this.selectedIndex == 0);
				$selectAllReset.prop('disabled', disabled);
				$selectText.prop('disabled', disabled);
				$selectTextReset.prop('disabled', disabled || $selectText.val().length == 0);
				disabled = !jQuery(this).find('option:selected').data('include-select-all-option-min');
				console.log(disabled);
				$selectAllMin.prop('disabled', disabled);
				$selectAllMinReset.prop('disabled', disabled || $selectAllMin.val().length == 0);
				break;
			case 'selectAllMin':
				this.value = this.value.replace(/\D+/g, '');
				document.getElementById('selectAllMin-reset-btn').disabled = (this.value.length == 0);
				break;
			case 'selectAllText':
				this.value = this.value.replace(/^\s+|\s+$/, '');
				document.getElementById('selectAllText-reset-btn').disabled = (this.value.length == 0);
				break;
			case 'collapsibleOptGroups':
			case 'filtering':
				document.getElementById(this.id + '-reset-btn').disabled = (this.selectedIndex == 0);
				break;
		}
		var options = {};
		if ($selectAll.prop('selectedIndex') > 0)
		{
			if ($selectAll.val() > 0)
			{
				options.includeSelectAllOption = true;
			}
			else if ($selectAll.find('option:selected').data('include-select-all-option-min'))
			{
				var allMin = $selectAllMin.val();
				if (allMin.length > 0)
				{
					options.includeSelectAllOptionMin = parseInt(allMin);
				}
			}
			var allText = $selectText.val();
			if (allText.length > 0)
			{
				options.selectAllText = allText;
			}
		}
		var $optgroups = jQuery('#collapsibleOptGroups').find('option:selected');
		if ($optgroups.data('enable-collapsible-opt-groups'))
		{
			options.enableCollapsibleOptGroups = true;
			if ($optgroups.data('collapse-opt-groups-by-default'))
			{
				options.collapseOptGroupsByDefault = true;
			}
		}
		var $filtering = jQuery('#filtering').find('option:selected');
		if ($filtering.data('enable-filtering'))
		{
			options.enableFiltering = true;
			if (!$filtering.data('enable-case-sensitive-filtering'))
			{
				options.enableCaseSensitiveFiltering = true;
			}
		}
		$mselect.multiselect('dispose').multiselect(options);
		document.getElementById('multiselect-params').textContent = (Object.keys(options).length > 0) ? JSON.stringify(options, null, "\t").replace(/"([^"]+)":/g, '$1:') : '';
	});
	jQuery('#option-count').text($mselect.find('option').length);
	jQuery('#selectAllMin-help').removeClass('d-none');
	$selectAll.prop('disabled', false);
});
</script>
</body>
</html>